---
title: "Seasonal/Annual Surface Temperatures (GrIS)"
author: "Shayne O'Brien"
date: "January 28, 2019"
output: html_document

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
The object of this item is to create Tables and Time Series for each year and each season for the PROMICE AWSs between 2009 and 2018.

```{r,message=FALSE, error=FALSE}
library(tidyr)
library(dplyr)
library(ggplot2)
library(DT)
```

#K - Transect

#Read in Data
```{r}
kan_u_df <- read.table(header = T, "Kan_U_day.txt") %>% 
  subset(AirTemperature.C. != -999)
kan_m_df <- read.table(header = T, "Kan_M_day.txt")
kan_l_df <- read.table(header = T, "Kan_L_day2.txt")

head(kan_u_df)
```
##Create Target Table

Create a table for only Year, Month, Day, Air temperature.

Then, add a new binary column, 1 for >0C, 0 for <0C

```{r}
KAN_U <- kan_u_df %>% 
  select(Year, MonthOfYear, AirTemperature.C.) 
  KAN_U$Melt <- as.numeric(KAN_U$AirTemperature.C. > 0)
  
  

KAN_M <- kan_m_df %>% 
  select(Year, MonthOfYear, DayOfMonth, AirTemperature.C.)
  KAN_M$Melt <- as.numeric(KAN_M$AirTemperature.C. > 0)

KAN_L <- kan_l_df %>% 
  select(Year, MonthOfYear, DayOfMonth, AirTemperature.C.)  
  KAN_L$Melt <- as.numeric(KAN_L$AirTemperature.C. > 0)
  
head(KAN_U)
  

```
##Create Monthly and Annual Tables
```{r}
kan_u_season <- KAN_U %>%
  rename(Month = MonthOfYear) %>% 
  mutate(Year = as.numeric(Year)) %>%
  group_by(Year, Month) %>%
  summarise(MeltDays = sum(Melt)) %>% 
  spread(Month, MeltDays)

kan_u_annual <- KAN_U %>%
  select(Year, Melt) %>% 
  mutate(Year = as.numeric(Year)) %>%
  group_by(Year) %>%
  summarise(MeltDays = sum(Melt))
  
datatable(
  kan_u_season, class = 'cell-border stripe', 
  rownames = FALSE, 
  colnames = c('Jan', 'Feb','Mar', 'Apr', 'May', 'Jun', 'July', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'),
  caption = htmltools::tags$caption(
  style = 'caption-side: bottom; text-align: center,',
  'Table 1: ', htmltools::em('This table displays the number of days per month with a temperature of > 0deg Celsius, 2009-2018')
  ))
datatable(
  kan_u_annual, class = 'cell-border stripe', 
  rownames = FALSE,
  caption = htmltools::tags$caption(
  style = 'caption-side: bottom; text-align: center,',
  'Table 1: ', htmltools::em('This table displays the number of days annually with a temperature of > 0deg Celsius, 2009-2018')
  ))

##c(Melt,Year(2009)))summarise(KAN_U, sum = sum(Melt))
#summarise(KAN_U, "2009" = sum(
```




##Isolate Temperatures by Year

##Isolate Temperatures by Season

##Plot
```{r fig.height=10, fig.width=12}
kan_u_plot <- kan_u_df
kan_u_plot$Date <- as.Date(with(kan_u_plot, paste(Year, MonthOfYear, DayOfMonth,sep="-")), "%d-%m-%Y")
   
   
ggplot(kan_u_plot, aes(DayOfYear, AirTemperature.C.))+
  geom_line()+
  facet_wrap(~Year,scales = "fixed", ncol = 3)+
  xlab("Degrees C")+
  ylab("Day of Year")
  
  

  
  

```

